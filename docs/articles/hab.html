<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>How to use the HAB functions • rivRmon</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="How to use the HAB functions">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-147990841-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-147990841-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rivRmon</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dbca-wa/rivRmon/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>How to use the HAB functions</h1>
                        <h4 data-toc-skip class="author">Bart
Huntley</h4>
            
            <h4 data-toc-skip class="date">2024-11-14</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/dbca-wa/rivRmon/blob/HEAD/vignettes/hab.Rmd" class="external-link"><code>vignettes/hab.Rmd</code></a></small>
      <div class="hidden name"><code>hab.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>These functions have been created to aid in compiling the HAB reports
by creating a conditionally formatted table in pptx format.</p>
</div>
<div class="section level2">
<h2 id="stage-one---create-summary-data">Stage One - Create summary data<a class="anchor" aria-label="anchor" href="#stage-one---create-summary-data"></a>
</h2>
<p>Phytoplankton count data in its raw form (hereafter called raw data)
provides count and other information for a multitude of species. This
data is analysed and provided to us by the Department of Water and
Environmental Regulation’s Phytoplankton Ecology Unit. In order to
compile the HAB report the data needs to be summarised to reflect only
HAB related data. This first stage undertakes this process and outputs
summaries that are used in stage two.</p>
<p>An important parameter for these functions is the
“mngt_response_triggers” csv. This is a csv file containing a table that
reflects current summary groups, included species and trigger threshold
values for the HAB report. This information not only guides the summary
but its layout also guides the final format of the output pptx file.
Below is an example.</p>
<p><img src="plots%2Fhab.PNG"></p>
<p>The table variables are:</p>
<ul>
<li>
<code>table_ord</code> this is the ordering of the
<code>table_name</code> groupings as they will appear in the final
output. Each unique group must have its own <code>table_ord</code>
number.</li>
<li>
<code>table_name</code> this is a broad grouping to which individual
species will be assigned to. Multiple species can be assigned to a
single group. This <code>table_name</code> reflects exactly the desired
format for the output pptx file.</li>
<li>
<code>spp_name</code> this is the species names and should follow
the same format, i.e.  snake_case. Make sure the spelling is as is
reported in the raw phytoplankton data.</li>
<li>
<code>surveillance</code> any value equal to this number and less
than or equal to the <code>notification</code> value will be classified
as “surveillance” and coloured orange in the output pptx file.</li>
<li>
<code>notification</code> any value greater than this will be
classified as “notification” and will be coloured red in the output pptx
file.</li>
</ul>
<p>To make things easier to setup, the <code>rivRmon</code> package
comes with an example. This can be read in, adjusted accordingly to
reflect current trigger species and thresholds and then saved to csv for
later use. To do this follow the example below.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#load the package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/dbca-wa/rivRmon" class="external-link">rivRmon</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">#assign the internal data to an object called triggers</span></span>
<span><span class="va">triggers</span> <span class="op">&lt;-</span> <span class="va">mngt_response_triggers</span></span>
<span></span>
<span><span class="co">#you can then save straight to csv and edit as you would an excel file</span></span>
<span><span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html" class="external-link">write_csv</a></span><span class="op">(</span><span class="va">triggers</span>, path <span class="op">=</span> <span class="st">"C:/some_file/path"</span><span class="op">)</span></span></code></pre></div>
<p>After making sure you have access to either the current management
trigger info, or have created your own, you need to supply two file
paths. One to the raw data xlsx spreadsheets and a file path to the
desired location of the exported summary data. This summary data will be
written to a <code>HAB_tables/</code> directory and if it doesn’t
already exist it will be created. Your next function call should look
something like the below.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#run the hab_groupR function</span></span>
<span><span class="fu"><a href="../reference/hab_groupR.html">hab_groupR</a></span><span class="op">(</span>pathin <span class="op">=</span> <span class="st">"C:/path/to/raw_data"</span>, pathout <span class="op">=</span> <span class="st">"C:/path/for_export"</span>,</span>
<span>           mngt_triggers <span class="op">=</span> <span class="st">"C:/path/to/trigger/data"</span><span class="op">)</span></span></code></pre></div>
<p>The only thing to be careful of is ensuring that if you are copying a
fiile path from a Windows OS you will need to double all the backslashes
for the path to be recognised. The above example is the alternative
method where the backslashes are converted to a single forward
slash.</p>
<p>Lastly there are two parameters that have default values.</p>
<ul>
<li>
<code>skip</code> defaults to 5. The format of the raw data has 5
lines of unrequired metadata at the top. If the format changes this can
be changed too.</li>
<li>
<code>shell</code> refers to a possible new site on the Canning
River. The default for this is FALSE. If this site becomes a permanent
addtion to the monitoring then changing this value to TRUE will ensure
this site is reflected in the summaries and output pptx file.</li>
</ul>
</div>
<div class="section level2">
<h2 id="stage-two---creating-the-conditionally-formatted-pptx-file">Stage Two - Creating the conditionally formatted pptx file<a class="anchor" aria-label="anchor" href="#stage-two---creating-the-conditionally-formatted-pptx-file"></a>
</h2>
<p>This next stage reads in all the summary HAB data csv’s and based on
the date provided, generates a table containing the current and prior
week’s cell counts for the groupings indicated in the trigger data with
conditionally coloured text to indicate classification.</p>
<p>To accomplish this, run code similar to the below.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#run the hab_tablR function</span></span>
<span><span class="fu"><a href="../reference/hab_tablR.html">hab_tablR</a></span><span class="op">(</span>hab_tables <span class="op">=</span> <span class="st">"C:/path/to/HAB_tables"</span>, date <span class="op">=</span> <span class="st">"20190715"</span>, </span>
<span>          mngt_triggers <span class="op">=</span> <span class="st">"C:/path/to/trigger/data"</span><span class="op">)</span></span></code></pre></div>
<p>The <code>hab_tables =</code> input for the <code><a href="../reference/hab_tablR.html">hab_tablR()</a></code>
function is a file path to the location of the <code>HAB_tables/</code>
directory not the summary csv’s themselves. This is essentially the
<strong>pathout</strong> parameter that you specified when running
<code><a href="../reference/hab_groupR.html">hab_groupR()</a></code>. Note that the format for the date is
“yyyymmdd” and can be presented as above in the code snippet or contain
separators (e.g. “2019/07/15” or “2019-07-15”).</p>
<p>The output will be a single page of a PowerPoint with a table of
different coloured counts per site (depending on the river). This table
can be then either incorporated into an existing report and formatted
for page size and any other tweaks or values can be copied out and put
into a “pre-formatted” table.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Bart Huntley.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
